<!-- Reusable Header Component -->
<header id="main-header" class="fixed top-0 left-0 right-0 z-50 transition-transform duration-300 -translate-y-full">
    <div class="bg-white/80 backdrop-blur-md shadow-md border-b border-gray-100">
        <div class="container mx-auto px-4 h-16 flex items-center justify-between">
            <!-- Logo Brand -->
            <a href="/dashboard" class="flex items-center gap-3 group">
                <div class="w-9 h-9 bg-blue-600 rounded-lg flex items-center justify-center shadow-sm group-hover:scale-105 transition-transform duration-200">
                    <span class="text-white font-bold text-sm">BK</span>
                </div>
                <div>
                    <h1 class="font-bold text-blue-900 text-lg leading-tight">HCMUT Tutor</h1>
                    <p class="text-xs text-blue-600/80 font-medium">System</p>
                </div>
            </a>

            <!-- Navigation Actions -->
            <div class="flex items-center gap-4">
                <a href="/dashboard" class="hidden md:flex items-center gap-2 text-sm font-medium text-gray-600 hover:text-blue-600 transition-colors px-3 py-2 rounded-md hover:bg-blue-50">
                    <!-- Icon placeholder if Lucide is not loaded yet, or rely on parent page to load it -->
                    <i data-lucide="layout-dashboard" class="w-4 h-4"></i>
                    Dashboard
                </a>
                <div class="h-6 w-px bg-gray-200 hidden md:block"></div>
                
                <!-- User Avatar / Profile -->
                <div class="flex items-center gap-2">
                    <div class="w-8 h-8 rounded-full bg-blue-100 border border-blue-200 flex items-center justify-center text-blue-700 font-bold text-xs shadow-sm">
                        <!-- Jinja2 logic to show first letter of name -->
                        {{ user.ho_ten[0] if user and user.ho_ten else 'U' }}
                    </div>
                    
                    <!-- Logout Button (Icon only on mobile, Text on Desktop) -->
                    <button onclick="handleLogout()" class="flex items-center gap-2 text-sm font-medium text-red-600 hover:text-red-700 transition-colors px-3 py-2 rounded-md hover:bg-red-50 ml-2" title="Đăng xuất">
                        <i data-lucide="log-out" class="w-4 h-4"></i>
                        <span class="hidden md:inline">Đăng xuất</span>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Inline script for header behavior -->
    <script>
        // Ensure this script runs even if included multiple times (though headers should be once per page)
        (function() {
            const header = document.getElementById('main-header');
            
            function updateHeaderVisibility() {
                if (window.scrollY > 50) {
                    header.classList.remove('-translate-y-full');
                } else {
                    header.classList.add('-translate-y-full');
                }
            }

            // Listen for scroll events
            window.addEventListener('scroll', updateHeaderVisibility);
            
            // Check initial state
            updateHeaderVisibility();
        })();

        // Logout Logic
        async function handleLogout() {
            try {
                const res = await fetch('/api/logout');
                const data = await res.json();
                if (data.success) {
                    window.location.href = "/";
                } else {
                    alert("Đăng xuất thất bại");
                }
            } catch (e) {
                console.error("Logout error:", e);
                // Fallback redirect even if fetch fails
                window.location.href = "/";
            }
        }
    </script>
</header>

<!-- Spacer to prevent content overlap when header appears or just for visual spacing -->
<div class="pt-16"></div>